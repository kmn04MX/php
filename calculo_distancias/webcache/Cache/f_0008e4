var idioma_esp = {
  processing: "Procesando...",
  lengthMenu: "Mostrar _MENU_ registros",
  zeroRecords: "No se encontraron resultados",
  emptyTable: "Ningún dato disponible en esta tabla",
  infoEmpty: "Mostrando registros del 0 al 0 de un total de 0 registros",
  infoFiltered: "(filtrado de un total de _MAX_ registros)",
  search: "Buscar:",
  infoThousands: ",",
  loadingRecords: "Cargando...",
  paginate: {
    first: "Primero",
    last: "Último",
    next: "Siguiente",
    previous: "Anterior",
  },
  aria: {
    sortAscending: ": Activar para ordenar la columna de manera ascendente",
    sortDescending:
      ": Activar para ordenar la columna de manera descendente",
  },
  buttons: {
    copy: "Copiar",
    colvis: "Visibilidad",
    collection: "Colección",
    colvisRestore: "Restaurar visibilidad",
    copyKeys:
      "Presione ctrl o u2318 + C para copiar los datos de la tabla al portapapeles del sistema. <br /> <br /> Para cancelar, haga clic en este mensaje o presione escape.",
    copySuccess: {
      1: "Copiada 1 fila al portapapeles",
      _: "Copiadas %ds fila al portapapeles",
    },
    copyTitle: "Copiar al portapapeles",
    csv: "CSV",
    excel: "Excel",
    pageLength: {
      "-1": "Mostrar todas las filas",
      _: "Mostrar %d filas",
    },
    pdf: "PDF",
    print: "Imprimir",
    renameState: "Cambiar nombre",
    updateState: "Actualizar",
    createState: "Crear Estado",
    removeAllStates: "Remover Estados",
    removeState: "Remover",
    savedStates: "Estados Guardados",
    stateRestore: "Estado %d",
  },
  autoFill: {
    cancel: "Cancelar",
    fill: "Rellene todas las celdas con <i>%d</i>",
    fillHorizontal: "Rellenar celdas horizontalmente",
    fillVertical: "Rellenar celdas verticalmentemente",
  },
  decimal: ",",
  searchBuilder: {
    add: "Añadir condición",
    button: {
      0: "Constructor de búsqueda",
      _: "Constructor de búsqueda (%d)",
    },
    clearAll: "Borrar todo",
    condition: "Condición",
    conditions: {
      date: {
        after: "Despues",
        before: "Antes",
        between: "Entre",
        empty: "Vacío",
        equals: "Igual a",
        notBetween: "No entre",
        notEmpty: "No Vacio",
        not: "Diferente de",
      },
      number: {
        between: "Entre",
        empty: "Vacio",
        equals: "Igual a",
        gt: "Mayor a",
        gte: "Mayor o igual a",
        lt: "Menor que",
        lte: "Menor o igual que",
        notBetween: "No entre",
        notEmpty: "No vacío",
        not: "Diferente de",
      },
      string: {
        contains: "Contiene",
        empty: "Vacío",
        endsWith: "Termina en",
        equals: "Igual a",
        notEmpty: "No Vacio",
        startsWith: "Empieza con",
        not: "Diferente de",
        notContains: "No Contiene",
        notStartsWith: "No empieza con",
        notEndsWith: "No termina con",
      },
      array: {
        not: "Diferente de",
        equals: "Igual",
        empty: "Vacío",
        contains: "Contiene",
        notEmpty: "No Vacío",
        without: "Sin",
      },
    },
    data: "Data",
    deleteTitle: "Eliminar regla de filtrado",
    leftTitle: "Criterios anulados",
    logicAnd: "Y",
    logicOr: "O",
    rightTitle: "Criterios de sangría",
    title: {
      0: "Constructor de búsqueda",
      _: "Constructor de búsqueda (%d)",
    },
    value: "Valor",
  },
  searchPanes: {
    clearMessage: "Borrar todo",
    collapse: {
      0: "Paneles de búsqueda",
      _: "Paneles de búsqueda (%d)",
    },
    count: "{total}",
    countFiltered: "{shown} ({total})",
    emptyPanes: "Sin paneles de búsqueda",
    loadMessage: "Cargando paneles de búsqueda",
    title: "Filtros Activos - %d",
    showMessage: "Mostrar Todo",
    collapseMessage: "Colapsar Todo",
  },
  select: {
    cells: {
      1: "1 celda seleccionada",
      _: "%d celdas seleccionadas",
    },
    columns: {
      1: "1 columna seleccionada",
      _: "%d columnas seleccionadas",
    },
    rows: {
      1: "1 fila seleccionada",
      _: "%d filas seleccionadas",
    },
  },
  thousands: ".",
  datetime: {
    previous: "Anterior",
    next: "Proximo",
    hours: "Horas",
    minutes: "Minutos",
    seconds: "Segundos",
    unknown: "-",
    amPm: ["AM", "PM"],
    months: {
      0: "Enero",
      1: "Febrero",
      10: "Noviembre",
      11: "Diciembre",
      2: "Marzo",
      3: "Abril",
      4: "Mayo",
      5: "Junio",
      6: "Julio",
      7: "Agosto",
      8: "Septiembre",
      9: "Octubre",
    },
    weekdays: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
  },
  editor: {
    close: "Cerrar",
    create: {
      button: "Nuevo",
      title: "Crear Nuevo Registro",
      submit: "Crear",
    },
    edit: {
      button: "Editar",
      title: "Editar Registro",
      submit: "Actualizar",
    },
    remove: {
      button: "Eliminar",
      title: "Eliminar Registro",
      submit: "Eliminar",
      confirm: {
        _: "¿Está seguro que desea eliminar %d filas?",
        1: "¿Está seguro que desea eliminar 1 fila?",
      },
    },
    error: {
      system:
        'Ha ocurrido un error en el sistema (<a target="\\" rel="\\ nofollow" href="\\">Más información&lt;\\/a&gt;).</a>',
    },
    multi: {
      title: "Múltiples Valores",
      info: "Los elementos seleccionados contienen diferentes valores para este registro. Para editar y establecer todos los elementos de este registro con el mismo valor, hacer click o tap aquí, de lo contrario conservarán sus valores individuales.",
      restore: "Deshacer Cambios",
      noMulti:
        "Este registro puede ser editado individualmente, pero no como parte de un grupo.",
    },
  },
  info: "Mostrando _START_ a _END_ de _TOTAL_ registros",
  stateRestore: {
    creationModal: {
      button: "Crear",
      name: "Nombre:",
      order: "Clasificación",
      paging: "Paginación",
      search: "Busqueda",
      select: "Seleccionar",
      columns: {
        search: "Búsqueda de Columna",
        visible: "Visibilidad de Columna",
      },
      title: "Crear Nuevo Estado",
      toggleLabel: "Incluir:",
    },
    emptyError: "El nombre no puede estar vacio",
    removeConfirm: "¿Seguro que quiere eliminar este %s?",
    removeError: "Error al eliminar el registro",
    removeJoiner: "y",
    removeSubmit: "Eliminar",
    renameButton: "Cambiar Nombre",
    renameLabel: "Nuevo nombre para %s",
    duplicateError: "Ya existe un Estado con este nombre.",
    emptyStates: "No hay Estados guardados",
    removeTitle: "Remover Estado",
    renameTitle: "Cambiar Nombre Estado",
  },
};

$(document).ready(function () {
  var btn = document.querySelector("#sendFolio");
  let dataTableOptions = {
    buttons: [
      {
        extend: "excelHtml5",
        text: '<i class="fas fa-file-excel"></i> ',
        titleAttr: "Exportar a Excel",
        className: "btn btn-success",
      },
      /*{
                extend: 'pdfHtml5',
                text: '<i class="fas fa-file-pdf"></i> ',
                titleAttr: 'Exportar a PDF',
                className: 'btn btn-danger',
            },
            /*{
                extend: 'print',
                text: '<i class="fa fa-print"></i> ',
                titleAttr: 'Imprimir',
                className: 'btn btn-info',
            },*/
    ],
    lengthMenu: [20, 50, 100, 500],
    columns: [
      { "data": "numeroPoliza" },
      {
        "data": "fechaReporte",
        render: function (row, data, index) {
          epochTofecha = epochToJsDate(row);
          return epochTofecha;
        },
      },
      { "data": "folioAsignacion" },
      { "data": "cuentaEspecial" },
      { "data": "clienteVip" },
      { "data": "codigoSiniestro" },
      { "data": "nombreReportante" },
      { "data": "apellidoPaternoReportante" },
      { "data": "apellidoMaternoReportante" },
      { "data": "numeroContacto" },
      { "data": "email" },
      { "data": "horaReporte" },
      { "data": "folioInternoGNP" },
      { "defaultContent": "<div class ='d-flex justify-content-center'><button class='btn btn-sm btn-warning' data-bs-toggle='modal' data-bs-target='#sendData'><i class='fa-solid fa-pencil'></i></button></div>" },
    ],
    columnDefs: [
      { className: "centered", targets: "_all" },
      { orderable: false, targets: "_all" },
    ],
    pageLength: 30,
    scrollX: true,
    scrollY: 350,
    destroy: true,
    language: idioma_esp
  };

  $("#tbServiciosAsignados").DataTable(dataTableOptions);
  let estatus = $("#estatus").val();
  if (estatus != "AS") {
    if (estatus == 'Buscar') {
      showBuscarFolio();
    } else {
      listarAsignadoByEstatus(estatus);
    }

  } else {
    listarAsignados();
  }

  $("#sendFolio").click(aginacionEstatus);
  $("#dataShowTable").click(limpiarCampos);
  $("#btnBuscarFolio").click(buscarFolio);


  function listarAsignados() {
    $.ajax({
      url: "../app/controllers/asignados_controller.php",
      type: "GET",
      dataType: "JSON",
      async: true,
      beforeSend: function (data) {
        setTimeout(function () {
          $("body").addClass("loaded");
        });
      },

      success: function (data) {

        if (!data.data.length) {
          alert("No se encontraron servicios asignados");
        } else {
          $("#tbServiciosAsignados").DataTable({
            dom: 'Bfrtip',
            buttons: [
              {
                extend: "excelHtml5",
                text: '<i class="fas fa-file-excel"></i> ',
                titleAttr: "Exportar a Excel",
                className: "btn btn-success",
              },
              /*{
                        extend: 'pdfHtml5',
                        text: '<i class="fas fa-file-pdf"></i> ',
                        titleAttr: 'Exportar a PDF',
                        className: 'btn btn-danger',
                    },
                    /*{
                        extend: 'print',
                        text: '<i class="fa fa-print"></i> ',
                        titleAttr: 'Imprimir',
                        className: 'btn btn-info',
                    },*/
            ],
            lengthMenu: [20, 50, 100, 500],
            data: data.data,
            columns: [
              { "data": "numeroPoliza" },
              {
                "data": "fechaReporte",
                render: function (row, data, index) {
                  epochTofecha = epochToJsDate(row);
                  return epochTofecha;
                },
              },
              { "data": "folioAsignacion" },
              { "data": "cuentaEspecial" },
              { "data": "clienteVip" },
              { "data": "codigoSiniestro" },
              { "data": "nombreReportante" },
              { "data": "apellidoPaternoReportante" },
              { "data": "apellidoMaternoReportante" },
              { "data": "numeroContacto" },
              { "data": "email" },
              { "data": "horaReporte" },
              { "data": "folioInternoGNP" },
              { "defaultContent": "<div class ='d-flex justify-content-center'><button class='btn btn-sm btn-warning'><i class='fa-solid fa-pencil'></i></button></div>" },
            ],
            columnDefs: [
              { className: "centered", targets: "_all" },
              { orderable: false, targets: "_all" },
            ],
            pageLength: 30,
            scrollX: true,
            scrollY: 310,
            destroy: true,
            language: idioma_esp
          });
        }
      },
      error: function (e) {
        alert(e.value);
        console.log(e);
      },
    });
  }

  function listarAsignadoByEstatus(estatus) {
    //let estatus = $("#estatus").val();
    var parametros = {
      estatus: estatus,
    };
    //console.log(parametros);
    $.ajax({
      url: "../app/controllers/estatus_controller.php",
      type: "POST",
      dataType: "JSON",
      data: { datos: JSON.stringify(parametros.estatus) },
      async: true,
      beforeSend: function (data) {
        setTimeout(function () {
          $("body").addClass("loaded");
        });
      },

      success: function (data) {
        if (!data.data.length) {
          switch (estatus) {
            case "CO":
              alert("No se encontraron servicios confirmados");
              break;
            case "EA":
              alert("No se encontraron servicios en atencion");
              break;
            case "AR":
              alert("No se encontraron servicios con arribo");
              break;
            case "IC":
              alert("No se encontraron servicios incompletos");
              break;
            case "TE":
              alert("No se encontraron servicios terminados");
              break;
            default:
              alert("No se encontraron servicios confirmados");
              break;
          }
        } else {
          //arrayDatos = Object.values(data.data);
          //consumoAsistencia(arrayDatos);
          $("#tbServiciosAsignados").DataTable({
            dom: 'Bflrtip',
            buttons: [
              {
                extend: "excelHtml5",
                text: '<i class="fas fa-file-excel"></i> ',
                titleAttr: "Exportar a Excel",
                className: "btn btn-success",
              },
              /*{
                        extend: 'pdfHtml5',
                        text: '<i class="fas fa-file-pdf"></i> ',
                        titleAttr: 'Exportar a PDF',
                        className: 'btn btn-danger',
                    },
                    /*{
                        extend: 'print',
                        text: '<i class="fa fa-print"></i> ',
                        titleAttr: 'Imprimir',
                        className: 'btn btn-info',
                    },*/
            ],
            lengthMenu: [20, 50, 100, 500],
            data: data.data,
            columns: [
              { "data": "numeroPoliza" },
              {
                "data": "fechaReporte",
                render: function (row, data, index) {
                  epochTofecha = epochToJsDate(row);
                  return epochTofecha;
                },
              },
              { "data": "folioAsignacion" },
              { "data": "cuentaEspecial" },
              { "data": "clienteVip" },
              { "data": "codigoSiniestro" },
              { "data": "nombreReportante" },
              { "data": "apellidoPaternoReportante" },
              { "data": "apellidoMaternoReportante" },
              { "data": "numeroContacto" },
              { "data": "email" },
              { "data": "horaReporte" },
              { "data": "folioInternoGNP" },
              { "defaultContent": "<div class ='d-flex justify-content-center'><button class='btn btn-sm btn-warning' data-bs-toggle='modal' data-bs-target='#sendData'><i class='fa-solid fa-pencil'></i></button></div>" },
            ],
            columnDefs: [
              { className: "centered", targets: "_all" },
              { orderable: false, targets: "_all" },
            ],
            pageLength: 30,
            scrollX: true,
            scrollY: 310,
            destroy: true,
            language: idioma_esp
          });
        }
      },
      error: function (e) {
        console.log(e);
      },
    });
  }

  function aginacionEstatus() {

    let folioGNP = $("#folioGNPNotify").val();
    let fecha = $("#fechaNotify").val();

    let estatusAsignar = $("#asigancion").val();
    let estatusActual = $("#estatus").val();

    let parametros = {
      folioGNP: folioGNP,
      fecha: jsDateToEpoch(fecha),
      estatusAsignar: estatusAsignar,
      estatusActual: estatusActual
    };

    $.ajax({
      url: "../app/controllers/cambiar_estatus.php",
      type: "POST",
      dataType: "JSON",
      data: { datos: JSON.stringify(parametros) },
      async: true,
      beforeSend: function (data) {
        setTimeout(function () {
          $("body").addClass("loaded");
        });
      },

      success: function (data) {
        emailIcon = document.querySelector(".fa-check");
        if (data.error == 1) {
          //let btn = document.querySelector("#sendFolio");
          alert(data.mensaje);
          btn.disabled = false;
          limpiarCampos();

        } else {
          let btn = document.querySelector("#sendFolio");
          $("#respuestaAWS").show();

          if (data.folioAsignacion != null && data.folioInternoGNP != null) {
            document.getElementById('respAWS').textContent = data.mensaje;
            btn.disabled = true;
            emailIcon.style.color = "#4bb543";
            //$('#tbServiciosAsignados').DataTable(dataTableOptions).ajax.reload();
          } else {
            document.getElementById('respAWS').textContent = data.mensaje;
            btn.disabled = false;
            emailIcon.classList.replace("fa-check", "fa-circle-xmark");
            emailIcon.style.color = "#de0611";
          }

        }
      },
      error: function (e) {
        console.log(e);
      },
    });
  }

  $(document).on("click", "#dataShowTable", function () {
    $("#seccion3").hide();
    $("#showButton").hide();
    $("#dataTableData").show();
    $("#titleTabla").show();
  });

  function showBuscarFolio() {
    $("#dataTableData").hide();
    $("#titleTabla").hide();
    $("#showButton").hide();
    $("#buscarDetalleByFolio").show();
    setTimeout(function () {
      $("body").addClass("loaded");
    });
  }

  $(document).on("click", ".btn-warning", function () {
    btn.disabled = false;
    $("#dataTableData").hide();
    $("#titleTabla").hide();
    $("#seccion3").show();
    $("#showButton").show();

    fila = $(this).closest("tr");
    numPoliza = fila.find("td:eq(0)").text();
    fechaReporte = fila.find("td:eq(1)").text();
    folioAsig = fila.find("td:eq(2)").text();
    cuentaEspcial = fila.find("td:eq(3)").text();
    clienteVip = fila.find("td:eq(4)").text();
    codigoSini = fila.find("td:eq(5)").text();
    nombreReport = fila.find("td:eq(6)").text();
    apellidoPatReport = fila.find("td:eq(7)").text();
    apellidoMatReport = fila.find("td:eq(8)").text();
    numContacto = fila.find("td:eq(9)").text();
    email = fila.find("td:eq(10)").text();
    horaReport = fila.find("td:eq(11)").text();
    folioIntGnp = fila.find("td:eq(12)").text();

    let hoy = new Date()
    let fecha = hoy.getFullYear() + '-' + ('0' + (hoy.getMonth() + 1)).slice(-2) + '-' + ('0' + hoy.getDate()).slice(-2);
    let hora = ('0' + hoy.getHours()).slice(-2) + ':' + ('0' + hoy.getMinutes()).slice(-2);

    let fecha_hora = fecha + 'T' + hora;
    //document.getElementById('fecha_hora').value = fecha_hora;
    //$("#fechaNotify").val(fecha_hora);

    let parametros = {
      folioAsignacion: folioAsig,
    };

    $.ajax({
      url: "../app/controllers/detalle_controller.php",
      type: "POST",
      dataType: "JSON",
      data: { datos: JSON.stringify(parametros.folioAsignacion) },
      async: true,
      beforeSend: function (data) { },

      success: function (data) {
        let dataFolio = data.data;
        //console.log(dataFolio);
        //seccion de datos Area 3 pantalla de seguimiento GNP
        $("#foasignacion").val(
          dataFolio.folioAsignacion != null && dataFolio.folioAsignacion != '' ? dataFolio.folioAsignacion : "---"
        );
        $("#foInGNP").val(
          dataFolio.folioInternoGNP != null && dataFolio.folioInternoGNP != '' ? dataFolio.folioInternoGNP : "---"
        );
        $("#cuEspecial").val(
          dataFolio.cuentaEspecial != null && dataFolio.cuentaEspecial != '' ? dataFolio.cuentaEspecial : "---"
        );
        $("#clVip").val(
          dataFolio.clienteVip != null && dataFolio.clienteVip != '' ? dataFolio.clienteVip : "---"
        );
        $("#cdSini").val(
          dataFolio.codigoSiniestro != null && dataFolio.codigoSiniestro != '' ? dataFolio.codigoSiniestro : "---"
        );
        $("#numPolicy").val(
          dataFolio.numeroPoliza != null && dataFolio.numeroPoliza != '' ? dataFolio.numeroPoliza : "---"
        );
        $("#numContact").val(
          dataFolio.numeroContacto != null && dataFolio.numeroContacto != '' ? dataFolio.numeroContacto : "---"
        );
        $("#personRep").val(
          dataFolio.nombreReportante + " " + dataFolio.apellidoPaternoReportante + " " + dataFolio.apellidoMaternoReportante
        );
        $("#nameReport").val(
          dataFolio.nombreReportante != null && dataFolio.nombreReportante != ''
            ? dataFolio.nombreReportante
            : "---"
        );
        $("#email").val(dataFolio.email != null && dataFolio.email != '' ? dataFolio.email : "---");
        $("#dateReport").val(
          epochToJsDate(
            dataFolio.fechaReporte != null ? dataFolio.fechaReporte : "---"
          )
        );
        $("#hrReport").val(
          dataFolio.horaReporte != null && dataFolio.horaReporte != '' ? dataFolio.horaReporte : "---"
        );
        $("#typeService").val(
          dataFolio.tipoServicio != null && dataFolio.tipoServicio != '' ? dataFolio.tipoServicio : "---"
        );
        $("#statusService").val(
          dataFolio.estatusServicio != null && dataFolio.estatusServicio != '' ? dataFolio.estatusServicio : "---"
        );

        $("#reUbicado").val(
          dataFolio.esReubicado != null && dataFolio.esReubicado != '' ? dataFolio.esReubicado : "---"
        );
        $("#dateReubicacdo").val(
          dataFolio.fechaHoraReubicacion != null && dataFolio.fechaHoraReubicacion != ''
            ? dataFolio.fechaHoraReubicacion
            : "---"
        );
        $("#coberturaAfectada").val(
          dataFolio.coberturaAfectada != null && dataFolio.coberturaAfectada != ''
            ? dataFolio.coberturaAfectada
            : "---"
        );
        $("#limitCobertura").val(
          dataFolio.limitesCobertura != null && dataFolio.limitesCobertura != ''
            ? dataFolio.limitesCobertura
            : "---"
        );
        $("#proveedor").val(
          dataFolio.proveedor != null && dataFolio.proveedor != ''
            ? dataFolio.proveedor
            : "---"
        );
        $("#sisOrigen").val(
          dataFolio.sistemaOrigen != null && dataFolio.sistemaOrigen != ''
            ? dataFolio.sistemaOrigen
            : "---"
        );
        $("#descServicio").val(
          dataFolio.descripcionServicio != '' && dataFolio.descripcionServicio != null
            ? dataFolio.descripcionServicio
            : "---"
        );

        $("#condicionesEspeciales").val(
          dataFolio.condicionesEspeciales != '' && dataFolio.condicionesEspeciales != null
            ? dataFolio.condicionesEspeciales
            : "---"
        );

        ////seccion de datos Area 3 detalles vehiculo pantalla de seguimiento GNP
        $("#typeVe").val(
          dataFolio.vehiculo.tipoVehiculo != null && dataFolio.vehiculo.tipoVehiculo != ''
            ? dataFolio.vehiculo.tipoVehiculo
            : "---"
        );
        $("#Marca").val(
          dataFolio.vehiculo.marca != null && dataFolio.vehiculo.marca != '' ? dataFolio.vehiculo.marca : "---"
        );
        $("#descripcionVe").val(
          dataFolio.vehiculo.descripcionVehiculo != null && dataFolio.vehiculo.descripcionVehiculo != ''
            ? dataFolio.vehiculo.descripcionVehiculo
            : "---"
        );
        $("#modVe").val(
          dataFolio.vehiculo.modelo != null && dataFolio.vehiculo.modelo != '' ? dataFolio.vehiculo.modelo : "---"
        );
        $("#numSerie").val(
          dataFolio.vehiculo.numeroSerie != null && dataFolio.vehiculo.numeroSerie != ''
            ? dataFolio.vehiculo.numeroSerie
            : "---"
        );
        $("#placas").val(
          dataFolio.vehiculo.placas != null && dataFolio.vehiculo.placas != '' ? dataFolio.vehiculo.placas : "---"
        );
        $("#color").val(
          dataFolio.vehiculo.color != null && dataFolio.vehiculo.color != ''
            ? dataFolio.vehiculo.color
            : "---"
        );

        ////seccion detalles origen
        $("#stOrigen").val(
          dataFolio.ubicacionOrigen.estadoOrigen != null && dataFolio.ubicacionOrigen.estadoOrigen != '' ? dataFolio.ubicacionOrigen.estadoOrigen : "---"
        );
        $("#MnOrigen").val(
          dataFolio.ubicacionOrigen.municipioOrigen != null && dataFolio.ubicacionOrigen.municipioOrigen != '' ? dataFolio.ubicacionOrigen.municipioOrigen : "---"
        );
        $("#clOrigen").val(
          dataFolio.ubicacionOrigen.calleOrigen != null && dataFolio.ubicacionOrigen.calleOrigen != '' ? dataFolio.ubicacionOrigen.calleOrigen : "---"
        );
        $("#colOrigen").val(
          dataFolio.ubicacionOrigen.plcoloniaOrigenacas != null && dataFolio.ubicacionOrigen.plcoloniaOrigenacas != '' ? dataFolio.ubicacionOrigen.plcoloniaOrigenacas : "---"
        );
        $("#cpOrigen").val(
          dataFolio.ubicacionOrigen.codigoPostalOrigen != null && dataFolio.ubicacionOrigen.codigoPostalOrigen != '' ? dataFolio.ubicacionOrigen.codigoPostalOrigen : "---"
        );
        $("#latOrigen").val(
          dataFolio.ubicacionOrigen.latitudOrigen != null && dataFolio.ubicacionOrigen.latitudOrigen != '' ? dataFolio.ubicacionOrigen.latitudOrigen : "---"
        );
        $("#lonOrigen").val(
          dataFolio.ubicacionOrigen.longitudOrigen != null && dataFolio.ubicacionOrigen.longitudOrigen != '' ? dataFolio.ubicacionOrigen.longitudOrigen : "---"
        );
        $("#nmextOrigen").val(
          dataFolio.ubicacionOrigen.numeroExteriorOrigen != null && dataFolio.ubicacionOrigen.numeroExteriorOrigen != '' ? dataFolio.ubicacionOrigen.numeroExteriorOrigen : "---"
        );
        $("#rfOrigen").val(
          dataFolio.ubicacionOrigen.referenciasOrigen != null && dataFolio.ubicacionOrigen.referenciasOrigen != '' ? dataFolio.ubicacionOrigen.referenciasOrigen : "---"
        );

        ////seccion detalles destino
        $("#stDestino").val(
          dataFolio.ubicacionDestino.estadoDestino != null && dataFolio.ubicacionDestino.estadoDestino != ''
            ? dataFolio.ubicacionDestino.estadoDestino : "---"
        );
        $("#MnDestino").val(
          dataFolio.ubicacionDestino.municipioDestino != null && dataFolio.ubicacionDestino.municipioDestino != ''
            ? dataFolio.ubicacionDestino.municipioDestino : "---"
        );
        $("#clDestino").val(
          dataFolio.ubicacionDestino.calleDestino != null && dataFolio.ubicacionDestino.calleDestino != ''
            ? dataFolio.ubicacionDestino.calleDestino : "---"
        );
        $("#colDestino").val(
          dataFolio.ubicacionDestino.coloniaDestino != null && dataFolio.ubicacionDestino.coloniaDestino != ''
            ? dataFolio.ubicacionDestino.coloniaDestino : "---"
        );
        $("#cpDestino").val(
          dataFolio.ubicacionDestino.codigoPostalDestino != null && dataFolio.ubicacionDestino.codigoPostalDestino != ''
            ? dataFolio.ubicacionDestino.codigoPostalDestino : "---"
        );
        $("#latDestino").val(
          dataFolio.ubicacionDestino.latitudDestino != null && dataFolio.ubicacionDestino.latitudDestino != ''
            ? dataFolio.ubicacionDestino.latitudDestino : "---"
        );
        $("#lonDestino").val(
          dataFolio.ubicacionDestino.longitudDestino != null && dataFolio.ubicacionDestino.longitudDestino != ''
            ? dataFolio.ubicacionDestino.longitudDestino : "---"
        );
        $("#nmextDestino").val(
          dataFolio.ubicacionDestino.numeroExteriorDestino != null && dataFolio.ubicacionDestino.numeroExteriorDestino != ''
            ? dataFolio.ubicacionDestino.numeroExteriorDestino : "---"
        );
        $("#rfDestino").val(
          dataFolio.ubicacionDestino.referenciasDestino != null && dataFolio.ubicacionDestino.referenciasDestino != ''
            ? dataFolio.ubicacionDestino.referenciasDestino : "---"
        );

        ////seccion preguntas
        let content = ``;
        dataFolio.preguntas.forEach((element, index) => {
          content += `
          <label>${element.pregunta}</label>
          <input type="text" class="form-control" value="${element.respuesta}" readonly>
          `;
        });
        preguntasEstatus.innerHTML = content;
        //seccion de datos Area 4 Notificacion de folio GNP pantalla de seguimiento GNP
        $("#folioGNPNotify").val(dataFolio.folioAsignacion);
      },
      error: function (e) {
        console.log(e);
      },
    });
  });

  function buscarFolio() {
    folioAsig = $("#buscarFolio").val();

    let hoy = new Date()
    let fecha = hoy.getFullYear() + '-' + ('0' + (hoy.getMonth() + 1)).slice(-2) + '-' + ('0' + hoy.getDate()).slice(-2);
    let hora = ('0' + hoy.getHours()).slice(-2) + ':' + ('0' + hoy.getMinutes()).slice(-2);
    let fecha_hora = fecha + 'T' + hora;

    let parametros = {
      folioAsignacion: folioAsig,
    };
    $.ajax({
      url: "../app/controllers/detalle_controller.php",
      type: "POST",
      dataType: "JSON",
      data: { datos: JSON.stringify(parametros.folioAsignacion) },
      async: true,
      beforeSend: function (data) {
        setTimeout(function () {
          $("body").addClass("loaded");
        });
        $('#mensajeCarga').show();
        $("#mostrarDetalleByFolio").hide();
      },

      success: function (data) {
        $('#mensajeCarga').hide();

        if (data.data == null) {
          alert("No se encontro el registro, Verifique el Folio ingresado");
          $("#mostrarDetalleByFolio").hide();
        } else {
          $("#mostrarDetalleByFolio").show();
          let dataFolio = data.data;
          //console.log(dataFolio);
          //seccion de datos Area 3 pantalla de seguimiento GNP
          $("#bfoasignacion").val(
            dataFolio.folioAsignacion != null && dataFolio.folioAsignacion != '' ? dataFolio.folioAsignacion : "---"
          );
          $("#bfoInGNP").val(
            dataFolio.folioInternoGNP != null && dataFolio.folioInternoGNP != '' ? dataFolio.folioInternoGNP : "---"
          );
          $("#bcuEspecial").val(
            dataFolio.cuentaEspecial != null && dataFolio.cuentaEspecial != '' ? dataFolio.cuentaEspecial : "---"
          );
          $("#bclVip").val(
            dataFolio.clienteVip != null && dataFolio.clienteVip != '' ? dataFolio.clienteVip : "---"
          );
          $("#bcdSini").val(
            dataFolio.codigoSiniestro != null && dataFolio.codigoSiniestro != '' ? dataFolio.codigoSiniestro : "---"
          );
          $("#bnumPolicy").val(
            dataFolio.numeroPoliza != null && dataFolio.numeroPoliza != '' ? dataFolio.numeroPoliza : "---"
          );
          $("#bnumContact").val(
            dataFolio.numeroContacto != null && dataFolio.numeroContacto != '' ? dataFolio.numeroContacto : "---"
          );
          $("#bpersonRep").val(
            dataFolio.nombreReportante + " " + dataFolio.apellidoPaternoReportante + " " + dataFolio.apellidoMaternoReportante
          );
          $("#bnameReport").val(
            dataFolio.nombreReportante != null && dataFolio.nombreReportante != ''
              ? dataFolio.nombreReportante
              : "---"
          );
          $("#bemail").val(dataFolio.email != null && dataFolio.email != '' ? dataFolio.email : "---");
          $("#bdateReport").val(
            epochToJsDate(
              dataFolio.fechaReporte != null ? dataFolio.fechaReporte : "---"
            )
          );
          $("#bhrReport").val(
            dataFolio.horaReporte != null && dataFolio.horaReporte != '' ? dataFolio.horaReporte : "---"
          );
          $("#btypeService").val(
            dataFolio.tipoServicio != null && dataFolio.tipoServicio != '' ? dataFolio.tipoServicio : "---"
          );
          $("#bstatusService").val(
            dataFolio.estatusServicio != null && dataFolio.estatusServicio != '' ? dataFolio.estatusServicio : "---"
          );

          $("#breUbicado").val(
            dataFolio.esReubicado != null && dataFolio.esReubicado != '' ? dataFolio.esReubicado : "---"
          );
          $("#bdateReubicacdo").val(
            dataFolio.fechaHoraReubicacion != null && dataFolio.fechaHoraReubicacion != ''
              ? dataFolio.fechaHoraReubicacion
              : "---"
          );
          $("#bcoberturaAfectada").val(
            dataFolio.coberturaAfectada != null && dataFolio.coberturaAfectada != ''
              ? dataFolio.coberturaAfectada
              : "---"
          );
          $("#blimitCobertura").val(
            dataFolio.limitesCobertura != null && dataFolio.limitesCobertura != ''
              ? dataFolio.limitesCobertura
              : "---"
          );
          $("#bproveedor").val(
            dataFolio.proveedor != null && dataFolio.proveedor != ''
              ? dataFolio.proveedor
              : "---"
          );
          $("#bsisOrigen").val(
            dataFolio.sistemaOrigen != null && dataFolio.sistemaOrigen != ''
              ? dataFolio.sistemaOrigen
              : "---"
          );
          $("#bdescServicio").val(
            dataFolio.descripcionServicio != '' && dataFolio.descripcionServicio != null
              ? dataFolio.descripcionServicio
              : "---"
          );

          $("#bcondici").val(
            dataFolio.condicionesEspeciales != '' && dataFolio.condicionesEspeciales != null
              ? dataFolio.condicionesEspeciales
              : "---"
          );

          ////seccion de datos Area 3 detalles vehiculo pantalla de seguimiento GNP
          $("#btypeVe").val(
            dataFolio.vehiculo.tipoVehiculo != null && dataFolio.vehiculo.tipoVehiculo != ''
              ? dataFolio.vehiculo.tipoVehiculo
              : "---"
          );
          $("#bMarca").val(
            dataFolio.vehiculo.marca != null && dataFolio.vehiculo.marca != '' ? dataFolio.vehiculo.marca : "---"
          );
          $("#bdescripcionVe").val(
            dataFolio.vehiculo.descripcionVehiculo != null && dataFolio.vehiculo.descripcionVehiculo != ''
              ? dataFolio.vehiculo.descripcionVehiculo
              : "---"
          );
          $("#bmodVe").val(
            dataFolio.vehiculo.modelo != null && dataFolio.vehiculo.modelo != '' ? dataFolio.vehiculo.modelo : "---"
          );
          $("#bnumSerie").val(
            dataFolio.vehiculo.numeroSerie != null && dataFolio.vehiculo.numeroSerie != ''
              ? dataFolio.vehiculo.numeroSerie
              : "---"
          );
          $("#bplacas").val(
            dataFolio.vehiculo.placas != null && dataFolio.vehiculo.placas != '' ? dataFolio.vehiculo.placas : "---"
          );
          $("#bcolor").val(
            dataFolio.vehiculo.color != null && dataFolio.vehiculo.color != ''
              ? dataFolio.vehiculo.color
              : "---"
          );

          ////seccion detalles origen
          $("#bstOrigen").val(
            dataFolio.ubicacionOrigen.estadoOrigen != null && dataFolio.ubicacionOrigen.estadoOrigen != '' ? dataFolio.ubicacionOrigen.estadoOrigen : "---"
          );
          $("#bMnOrigen").val(
            dataFolio.ubicacionOrigen.municipioOrigen != null && dataFolio.ubicacionOrigen.municipioOrigen != '' ? dataFolio.ubicacionOrigen.municipioOrigen : "---"
          );
          $("#bclOrigen").val(
            dataFolio.ubicacionOrigen.calleOrigen != null && dataFolio.ubicacionOrigen.calleOrigen != '' ? dataFolio.ubicacionOrigen.calleOrigen : "---"
          );
          $("#bcolOrigen").val(
            dataFolio.ubicacionOrigen.plcoloniaOrigenacas != null && dataFolio.ubicacionOrigen.plcoloniaOrigenacas != '' ? dataFolio.ubicacionOrigen.plcoloniaOrigenacas : "---"
          );
          $("#bcpOrigen").val(
            dataFolio.ubicacionOrigen.codigoPostalOrigen != null && dataFolio.ubicacionOrigen.codigoPostalOrigen != '' ? dataFolio.ubicacionOrigen.codigoPostalOrigen : "---"
          );
          $("#blatOrigen").val(
            dataFolio.ubicacionOrigen.latitudOrigen != null && dataFolio.ubicacionOrigen.latitudOrigen != '' ? dataFolio.ubicacionOrigen.latitudOrigen : "---"
          );
          $("#blonOrigen").val(
            dataFolio.ubicacionOrigen.longitudOrigen != null && dataFolio.ubicacionOrigen.longitudOrigen != '' ? dataFolio.ubicacionOrigen.longitudOrigen : "---"
          );
          $("#bnmextOrigen").val(
            dataFolio.ubicacionOrigen.numeroExteriorOrigen != null && dataFolio.ubicacionOrigen.numeroExteriorOrigen != '' ? dataFolio.ubicacionOrigen.numeroExteriorOrigen : "---"
          );
          $("#brfOrigen").val(
            dataFolio.ubicacionOrigen.referenciasOrigen != null && dataFolio.ubicacionOrigen.referenciasOrigen != '' ? dataFolio.ubicacionOrigen.referenciasOrigen : "---"
          );

          ////seccion detalles destino
          $("#bstDestino").val(
            dataFolio.ubicacionDestino.estadoDestino != null && dataFolio.ubicacionDestino.estadoDestino != ''
              ? dataFolio.ubicacionDestino.estadoDestino : "---"
          );
          $("#bMnDestino").val(
            dataFolio.ubicacionDestino.municipioDestino != null && dataFolio.ubicacionDestino.municipioDestino != ''
              ? dataFolio.ubicacionDestino.municipioDestino : "---"
          );
          $("#bclDestino").val(
            dataFolio.ubicacionDestino.calleDestino != null && dataFolio.ubicacionDestino.calleDestino != ''
              ? dataFolio.ubicacionDestino.calleDestino : "---"
          );
          $("#bcolDestino").val(
            dataFolio.ubicacionDestino.coloniaDestino != null && dataFolio.ubicacionDestino.coloniaDestino != ''
              ? dataFolio.ubicacionDestino.coloniaDestino : "---"
          );
          $("#bcpDestino").val(
            dataFolio.ubicacionDestino.codigoPostalDestino != null && dataFolio.ubicacionDestino.codigoPostalDestino != ''
              ? dataFolio.ubicacionDestino.codigoPostalDestino : "---"
          );
          $("#blatDestino").val(
            dataFolio.ubicacionDestino.latitudDestino != null && dataFolio.ubicacionDestino.latitudDestino != ''
              ? dataFolio.ubicacionDestino.latitudDestino : "---"
          );
          $("#blonDestino").val(
            dataFolio.ubicacionDestino.longitudDestino != null && dataFolio.ubicacionDestino.longitudDestino != ''
              ? dataFolio.ubicacionDestino.longitudDestino : "---"
          );
          $("#bnmextDestino").val(
            dataFolio.ubicacionDestino.numeroExteriorDestino != null && dataFolio.ubicacionDestino.numeroExteriorDestino != ''
              ? dataFolio.ubicacionDestino.numeroExteriorDestino : "---"
          );
          $("#brfDestino").val(
            dataFolio.ubicacionDestino.referenciasDestino != null && dataFolio.ubicacionDestino.referenciasDestino != ''
              ? dataFolio.ubicacionDestino.referenciasDestino : "---"
          );

          ////seccion preguntas
          let content = ``;
          dataFolio.preguntas.forEach((element, index) => {
            content += `
            <label class="text-right" for="foasignacion">${element.pregunta}</label>
            <input type="text" class="form-control" name="foasignacion" id="typeVe" value="${element.respuesta}" readonly>
            `;
          });
          bpreguntasEstatus.innerHTML = content;
          //seccion de datos Area 4 Notificacion de folio GNP pantalla de seguimiento GNP
          $("#folioGNPNotify").val(dataFolio.folioAsignacion);
        }
      },
      error: function (e) {
        console.log(e);
      },
    });
  }

  //funcion para convertir de una epoca a fecha
  function epochToJsDate(ts) {
    let epoch = new Date(parseInt(ts));
    let date = epoch.toLocaleDateString();

    //let datetoEpoch = jsDateToEpoch(epoch);
    //console.log(datetoEpoch);
    return date;
  }

  //funcion para convertir de una fecha a epoca
  function jsDateToEpoch(d) {
    var myDate = new Date(d); // Your timezone!
    var myEpoch = myDate.getTime() / 1000.0;

    return myEpoch;
  }

  function limpiarCampos(params) {
    document.getElementById("myform").reset();
    document.getElementById("formularioDetalle").reset();
    $("#respuestaAWS").hide();
  }
});
